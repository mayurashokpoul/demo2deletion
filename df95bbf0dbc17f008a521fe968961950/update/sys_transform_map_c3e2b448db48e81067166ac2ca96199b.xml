<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_transform_map">
    <sys_transform_map action="INSERT_OR_UPDATE">
        <active>true</active>
        <copy_empty_fields>false</copy_empty_fields>
        <create_new_record_on_empty_coalesce_fields>false</create_new_record_on_empty_coalesce_fields>
        <enforce_mandatory_fields>No</enforce_mandatory_fields>
        <name>Box Label Asset Data Map</name>
        <order>100</order>
        <run_business_rules>false</run_business_rules>
        <run_script>true</run_script>
        <script><![CDATA[(function transformRow(source, target, map, log, isUpdate) {
    if (gs.getProperty('glide.sys.domain.enabled') == 'true') {
        if (source.sourceid) {
            var cusomerRegistration = new GlideRecord('x_inmis_im_itad_customer_registration');
            cusomerRegistration.addQuery('source_id', source.sourceid);
            cusomerRegistration.query();
            if (cusomerRegistration.next()) {
                target.sys_domain = cusomerRegistration.company.sys_domain;
            }
        }
    }
       //Update Alm Hardware substatus as Onsite Services-Completed
    if (source.site == "Onsite Audit") {
        var hardware = new GlideRecord('alm_hardware');
        if (gs.getProperty('glide.sys.domain.enabled') == 'true' && source.sourceid) {
            hardware.addQuery('company', cusomerRegistration.company.sys_id);
        }
        hardware.addEncodedQuery('serial_number=' + source.serialnumber);
        hardware.query();
        if (hardware.next()) {
            hardware.install_status = (source.state == "In Transit") ? 9 : source.state;
            hardware.substatus = source.substate;
            hardware.update();
        }

        //update Device Action value on IMITAD hardware
    } else if (source.site == "SORT") {     
        var hardware = new GlideRecord('alm_hardware');
        if (gs.getProperty('glide.sys.domain.enabled') == 'true' && source.sourceid) {
            hardware.addQuery('company', cusomerRegistration.company.sys_id);
        }
        hardware.addEncodedQuery('serial_number=' + source.serialnumber);
        hardware.query();
        if (hardware.next()) {
            hardware.install_status = '6'; // In Stock
            hardware.substatus = source.substate;
            hardware.update();
        }
    }

})(source, target, map, log, action === "update");]]></script>
        <source_table>x_inmis_im_itad_box_or_label_asset_update</source_table>
        <sys_class_name>sys_transform_map</sys_class_name>
        <sys_created_by>Munimohan.Bathala@ness.com</sys_created_by>
        <sys_created_on>2020-10-19 07:04:47</sys_created_on>
        <sys_id>c3e2b448db48e81067166ac2ca96199b</sys_id>
        <sys_mod_count>13</sys_mod_count>
        <sys_name>Box Label Asset Data Map</sys_name>
        <sys_package display_value="Ingram Micro IT Asset Disposition" source="x_inmis_im_itad">df95bbf0dbc17f008a521fe968961950</sys_package>
        <sys_policy/>
        <sys_scope display_value="Ingram Micro IT Asset Disposition">df95bbf0dbc17f008a521fe968961950</sys_scope>
        <sys_update_name>sys_transform_map_c3e2b448db48e81067166ac2ca96199b</sys_update_name>
        <sys_updated_by>Ruthvic.voladri@ness.com</sys_updated_by>
        <sys_updated_on>2021-03-10 11:21:13</sys_updated_on>
        <target_table>x_inmis_im_itad_imitad_hardware</target_table>
    </sys_transform_map>
</record_update>
